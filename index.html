<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniDeck: Lecture Builder</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --bg: #f4f7f6;
            --text: #333;
            --slide-bg: #ffffff;
            --slide-ratio: 1.77; /* 16:9 Aspect Ratio */
        }

        * { box-sizing: border-box; }
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* HEADER */
        header { background: var(--primary); color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
        h1 { margin: 0; font-size: 1.2rem; }
        .btn { background: var(--accent); border: none; color: white; padding: 0.5rem 1rem; cursor: pointer; border-radius: 4px; font-weight: bold; }
        .btn:hover { opacity: 0.9; }
        .btn-danger { background: #e74c3c; }
        .btn-success { background: #27ae60; }

        /* MAIN EDITOR LAYOUT */
        .workspace { display: flex; flex: 1; height: 100%; overflow: hidden; }
        
        /* SIDEBAR (Slide List) */
        .sidebar { width: 250px; background: #e0e0e0; border-right: 1px solid #ccc; display: flex; flex-direction: column; }
        .slide-list { flex: 1; overflow-y: auto; padding: 10px; }
        .slide-thumbnail { background: white; border: 2px solid transparent; margin-bottom: 10px; padding: 10px; cursor: pointer; height: 100px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; color: #888; position: relative; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .slide-thumbnail.active { border-color: var(--accent); }
        .slide-num { position: absolute; top: 2px; left: 5px; font-weight: bold; color: #ccc; }
        
        /* EDITOR PANE */
        .editor-pane { flex: 1; padding: 20px; background: var(--bg); display: flex; flex-direction: column; overflow-y: auto; border-right: 1px solid #ddd; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: var(--primary); }
        input[type="text"], textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-family: inherit; }
        textarea { height: 150px; resize: vertical; }
        .note { font-size: 0.85rem; color: #666; margin-top: 5px; }

        /* PREVIEW PANE */
        .preview-pane { flex: 1.5; background: #ccc; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .slide-frame {
            background: var(--slide-bg);
            width: 90%;
            aspect-ratio: var(--slide-ratio);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        /* SLIDE STYLES */
        .slide-content h2 { color: var(--primary); margin-top: 0; font-size: 2.5rem; }
        .slide-content ul { font-size: 1.5rem; line-height: 1.6; color: var(--text); }
        .slide-content p { font-size: 1.5rem; line-height: 1.6; }
        .footer { position: absolute; bottom: 10px; right: 20px; font-size: 0.8rem; color: #999; }

        /* PRESENTATION MODE OVERLAY */
        #present-mode {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: black; z-index: 1000; display: none;
            align-items: center; justify-content: center;
        }
        #present-slide {
            background: white; width: 80vw; aspect-ratio: var(--slide-ratio);
            padding: 5vw; display: flex; flex-direction: column; justify-content: center;
            font-size: 1.5vw; /* Responsive font sizing */
        }
        #present-slide h2 { font-size: 3em; margin-bottom: 0.5em; color: var(--primary); }
        #present-slide li { font-size: 1.5em; margin-bottom: 0.5em; }
        #present-slide p { font-size: 1.5em; }
        .controls { position: fixed; bottom: 20px; right: 20px; opacity: 0; transition: opacity 0.3s; }
        #present-mode:hover .controls { opacity: 1; }

    </style>
</head>
<body>

<header>
    <h1>UniDeck Creator</h1>
    <div>
        <button class="btn" onclick="addSlide()">+ New Slide</button>
        <button class="btn btn-success" onclick="startPresentation()">▶ Present</button>
    </div>
</header>

<div class="workspace">
    <div class="sidebar">
        <div class="slide-list" id="slideListContainer">
            </div>
    </div>

    <div class="editor-pane">
        <h2>Edit Slide</h2>
        <div class="form-group">
            <label>Title</label>
            <input type="text" id="inputTitle" oninput="updateCurrentSlide()" placeholder="e.g. Introduction to Calculus">
        </div>
        <div class="form-group">
            <label>Body Content (Bullet Points)</label>
            <textarea id="inputBody" oninput="updateCurrentSlide()" placeholder="Enter text here...&#10;- Use hyphens for bullets"></textarea>
            <p class="note">Tip: Start lines with "-" to create bullet points.</p>
        </div>
        <div class="form-group">
            <label>Slide Layout</label>
            <select id="inputLayout" onchange="updateCurrentSlide()" style="width:100%; padding:10px;">
                <option value="standard">Title & Bullets</option>
                <option value="center">Centered Heading</option>
            </select>
        </div>
        <div style="margin-top:auto;">
            <button class="btn btn-danger" onclick="deleteSlide()">Delete Slide</button>
        </div>
    </div>

    <div class="preview-pane">
        <div class="slide-frame" id="previewFrame">
            <div class="slide-content" id="previewContent">
                </div>
            <div class="footer">UniDeck v1.0</div>
        </div>
    </div>
</div>

<div id="present-mode">
    <div id="present-slide">
        </div>
    <div class="controls">
        <button class="btn" onclick="prevSlide()">❮ Prev</button>
        <button class="btn" onclick="nextSlide()">Next ❯</button>
        <button class="btn btn-danger" onclick="exitPresentation()">Exit</button>
    </div>
</div>

<script>
    // --- STATE MANAGEMENT ---
    let slides = [
        { title: "Welcome to Class", body: "- Introduction to the topic\n- Key learning objectives\n- Assessment criteria", layout: "standard" },
        { title: "Today's Agenda", body: "1. Theory Review\n2. Case Studies\n3. Group Discussion", layout: "standard" }
    ];
    let currentIndex = 0;
    let isPresenting = false;

    // --- DOM ELEMENTS ---
    const titleInput = document.getElementById('inputTitle');
    const bodyInput = document.getElementById('inputBody');
    const layoutInput = document.getElementById('inputLayout');
    const previewContent = document.getElementById('previewContent');
    const listContainer = document.getElementById('slideListContainer');
    const presentMode = document.getElementById('present-mode');
    const presentSlideContent = document.getElementById('present-slide');

    // --- INITIALIZATION ---
    function init() {
        renderList();
        loadSlide(0);
    }

    // --- CORE FUNCTIONS ---
    function addSlide() {
        slides.push({ title: "New Slide", body: "- Add content here", layout: "standard" });
        renderList();
        loadSlide(slides.length - 1);
    }

    function deleteSlide() {
        if (slides.length <= 1) return alert("You must have at least one slide.");
        slides.splice(currentIndex, 1);
        currentIndex = Math.max(0, currentIndex - 1);
        renderList();
        loadSlide(currentIndex);
    }

    function loadSlide(index) {
        currentIndex = index;
        const slide = slides[index];
        
        // Populate inputs
        titleInput.value = slide.title;
        bodyInput.value = slide.body;
        layoutInput.value = slide.layout;

        // Update UI highlights
        document.querySelectorAll('.slide-thumbnail').forEach((el, i) => {
            el.classList.toggle('active', i === index);
        });

        renderPreview();
    }

    function updateCurrentSlide() {
        slides[currentIndex].title = titleInput.value;
        slides[currentIndex].body = bodyInput.value;
        slides[currentIndex].layout = layoutInput.value;
        renderListTextOnly(); // Optimization: don't re-render whole DOM, just text
        renderPreview();
    }

    // --- RENDERING ---
    function formatBodyText(text) {
        // Simple parser: turns lines starting with "-" into li, others into p
        if (!text) return "";
        let html = "";
        let inList = false;
        
        const lines = text.split('\n');
        
        lines.forEach(line => {
            if (line.trim().startsWith('-')) {
                if (!inList) { html += "<ul>"; inList = true; }
                html += `<li>${line.trim().substring(1)}</li>`;
            } else {
                if (inList) { html += "</ul>"; inList = false; }
                if (line.trim() !== "") html += `<p>${line}</p>`;
            }
        });
        if (inList) html += "</ul>";
        return html;
    }

    function renderPreview(targetElement = previewContent) {
        const slide = slides[currentIndex];
        let content = "";

        if (slide.layout === 'center') {
            targetElement.style.textAlign = 'center';
            content = `<h1>${slide.title}</h1>${formatBodyText(slide.body)}`;
        } else {
            targetElement.style.textAlign = 'left';
            content = `<h2>${slide.title}</h2>${formatBodyText(slide.body)}`;
        }
        targetElement.innerHTML = content;
    }

    function renderList() {
        listContainer.innerHTML = "";
        slides.forEach((slide, index) => {
            const div = document.createElement('div');
            div.className = `slide-thumbnail ${index === currentIndex ? 'active' : ''}`;
            div.onclick = () => loadSlide(index);
            div.innerHTML = `<span class="slide-num">${index + 1}</span> <div style="overflow:hidden; height:100%;">${slide.title}</div>`;
            listContainer.appendChild(div);
        });
    }

    function renderListTextOnly() {
        // Updates the text in the sidebar without rebuilding DOM elements
        const thumbs = listContainer.children;
        if(thumbs[currentIndex]) {
             thumbs[currentIndex].querySelector('div').innerText = slides[currentIndex].title;
        }
    }

    // --- PRESENTATION MODE ---
    function startPresentation() {
        isPresenting = true;
        presentMode.style.display = 'flex';
        renderPresentationSlide();
        
        // Enter Fullscreen
        if (document.documentElement.requestFullscreen) {
            document.documentElement.requestFullscreen();
        }
    }

    function exitPresentation() {
        isPresenting = false;
        presentMode.style.display = 'none';
        if (document.exitFullscreen) {
            document.exitFullscreen();
        }
    }

    function renderPresentationSlide() {
        const slide = slides[currentIndex];
        let content = "";
        if (slide.layout === 'center') {
            presentSlideContent.style.textAlign = 'center';
            content = `<h1 style="font-size:4em">${slide.title}</h1>${formatBodyText(slide.body)}`;
        } else {
            presentSlideContent.style.textAlign = 'left';
            content = `<h2>${slide.title}</h2>${formatBodyText(slide.body)}`;
        }
        presentSlideContent.innerHTML = content;
    }

    function nextSlide() {
        if (currentIndex < slides.length - 1) {
            currentIndex++;
            renderPresentationSlide();
        }
    }

    function prevSlide() {
        if (currentIndex > 0) {
            currentIndex--;
            renderPresentationSlide();
        }
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
        if (!isPresenting) return;
        if (e.key === "ArrowRight" || e.key === "Space") nextSlide();
        if (e.key === "ArrowLeft") prevSlide();
        if (e.key === "Escape") exitPresentation();
    });

    init();
</script>

</body>
</html>
